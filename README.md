# 实时光线追踪渲染器

这是一个基于OpenGL的实时光线追踪渲染器，使用C++和GLSL实现。该项目能够渲染Stanford Bunny模型和两个球体（一个具有漫反射材质，另一个具有玻璃材质），并支持相机移动控制。

## 功能特性

- 实时光线追踪渲染
- 材质系统（漫反射、金属、玻璃）
- 支持反射和折射
- 阴影计算
- 漫反射和镜面反射
- 可交互相机控制（WASD+鼠标）
- Stanford Bunny模型加载

## 系统需求

- C++17 兼容的编译器（Visual Studio推荐）
- OpenGL 3.3或更高版本
- CMake 3.10或更高版本

## 依赖库

- GLFW (窗口创建与输入处理)
- GLM (数学库)
- GLAD (OpenGL函数加载)
- tinyobjloader (OBJ模型加载)

## 项目结构

```
.
├── include/             # 头文件
│   ├── camera.h        # 相机系统
│   └── shader.h        # 着色器类
├── src/                # 源代码
│   ├── main.cpp        # 主程序
│   ├── shader.cpp      # 着色器实现
│   └── glad.c          # OpenGL加载器
├── shaders/            # GLSL着色器
│   ├── raytrace.vert   # 顶点着色器
│   └── raytrace.frag   # 片段着色器(光线追踪核心)
├── models/             # 3D模型
│   └── bunny.obj       # Stanford Bunny模型
├── external/           # 第三方库
│   ├── include/        # 第三方头文件
│   └── lib/            # 预编译库文件
└── CMakeLists.txt      # CMake构建配置
```

## 编译与运行

### 在Windows上使用Visual Studio和CMake

1. 确保已安装Visual Studio和CMake
2. 克隆或下载此项目
3. 创建构建目录：
   ```
   mkdir build
   cd build
   ```
4. 配置并生成项目：
   ```
   cmake .. -G "Visual Studio 16 2019" -A x64
   ```
   (根据你的Visual Studio版本调整命令)
5. 打开生成的.sln文件并构建解决方案
6. 运行可执行文件

## 使用方法

启动程序后，可以使用以下控制：

- `W`, `A`, `S`, `D`: 移动相机
- 鼠标: 旋转视角
- 鼠标滚轮: 调整视野大小
- `ESC`: 退出程序

## 实现细节

### 光线追踪核心算法

项目使用了OpenGL着色器在GPU上实现的光线追踪算法。主要步骤包括：

1. 从相机发射光线
2. 检测光线与场景物体的交点
3. 根据材质属性计算着色
4. 对于反射/折射材质，继续跟踪反射/折射光线
5. 直到达到最大弹射次数或者光线未命中任何物体

### 着色器实现

片段着色器中实现了完整的光线追踪算法：

- 光线-三角形相交测试
- 光线-球体相交测试
- 反射和折射计算
- 菲涅尔效应（使用Schlick近似）
- 阴影计算
- 光照模型

### 性能考量

为了实现实时渲染：

- 限制了最大光线弹射次数
- 使用迭代而非递归（GLSL不支持递归）
- 简化了某些光照计算
- 优化了数据结构

## 后续改进方向

- 实现更多高级特性（景深、运动模糊等）
- 添加BVH加速结构以提高渲染复杂模型的性能
- 实现更先进的采样策略
- 添加纹理支持
- 实现全局光照算法（路径追踪）

## 许可证

此项目采用MIT许可证。有关详细信息，请参阅LICENSE文件。
